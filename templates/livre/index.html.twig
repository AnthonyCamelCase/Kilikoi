{% extends 'base.html.twig' %}

{% block title %}Hello LivreController!{% endblock %}

{% block body %}

<h1 class="text-center mb-3">{{ livre.titre }}</h1>
<h2 class="text-center mb-4">de {{ livre.auteur }}</h2>

<hr>
<div class="container text-center">
    <img class="mx-auto d-block mb-4 mt-4" src="{{ asset('image/'~ livre.titre ~ '.jpg' )}}" width="305" height="500" alt="couvertureDeLivre">
    <!-- bouton ajouter à la liste de lecture -->
    {% if app.user %}
        {% if livre.titre in testlivre %}
            <p>Ce livre fait partie de votre liste de lecture.</p>
        {% else %}
            <a href="{{path('ajoutLivre',{"titre":livre.titre}) }}">Ajouter à votre liste de lecture</a>
        {% endif %} 
    {% endif %}
</div>
<!--Affichage des infos sur le livre-->
<div class="container ">
    <ul class="list-unstyled text-center">
        {% if livre.saga %}
            <li>Ce livre fait partie de la sage {{livre.saga}}.</li>
        {% endif %}
        <li> Il contient {{ livre.nombreMots }} mots.</li>
    </ul>
</div>

<hr>
<!--Affichage des commentaires sur le livre-->
<div class="container">
    <h2 class="text-center">Les avis sur ce livre :</h2>
    {% for com in coms %}
    <div class="container">
        <h3> {{ com.titre }} </h3>
        <p> {{ com.contenu }} </p>
        <p>
            écrit par
            {{ com.utilisateur }}
            le
            {{ com.date|date('d/m/Y') }}
        </p>
    </div>
    {% else %}
    <p>Il n'y a pas encore de commentaire !</p>
    {% endfor %}
</div>

{% if app.user %}
    <hr>
    {% if livre in liste.livre %}
        
        <!--Ajouter un commentaire sur le livre-->
        <h3 class="text-center">Ecrire un avis sur ce livre</h3>
        <div class="container text-center">	
            {{ form_start(formCommentaire) }}
            <div class="mb-2">{{ form_label(formCommentaire.titre) }}</div>
            <div class="mb-4 ">{{ form_widget(formCommentaire.titre, { 'attr': {'placeholder': "exemple@mail.fr"}}) }}</div>
            <div class="mb-2">{{ form_label(formCommentaire.contenu) }}</div>
            <div class="mb-4">{{ form_widget(formCommentaire.contenu, { 'attr': {'placeholder': "restez correct"}}) }}</div>
            <button class="btn btn-lg btn-danger">Publier le commentaire</button>
            {{ form_end(formCommentaire) }}
        </div>   
    {% else %}
        Vous devez avoir lu et ajouter ce livre à votre liste de lecture pour donner votre avis.
    {% endif %}
    
{% endif %}


{% endblock %}
